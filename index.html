<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>InAFlash</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">
</head>

<body class="light-mode">
  <div class="app">
    <!-- Header -->
    <header>
      <h1><i class="fas fa-bolt"></i> InAFlash</h1>
      <div class="header-actions">
        <button id="toggleThemeBtn"><i class="fas fa-moon"></i></button>
        <div id="userActions" class="hidden">
          <span id="userEmail" style="margin-right: 10px;"></span>
          <button id="logoutBtn" class="secondary-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
        </div>
      </div>
    </header>

    <!-- Home Screen (Landing Page) -->
    <div class="screen" id="homeScreen">
      <div class="landing-content">
        <div class="landing-hero">
          <h1>Master Your Studies with Ultimate Flashcards</h1>
          <p>Create, study, and ace your exams with our powerful spaced repetition system.</p>
          <div class="landing-actions">
            <button id="getStartedBtn" class="primary-btn landing-btn">Get Started</button>
            <button id="loginBtn" class="secondary-btn landing-btn">Login</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Auth Screen -->
    <div class="screen hidden" id="authScreen">
      <div class="auth-container">
        <div class="auth-box">
          <h2 id="authTitle">Login</h2>
          <form id="authForm">
            <div class="form-group">
              <label for="email">Email</label>
              <input type="email" id="email" required placeholder="Enter your email">
            </div>
            <div class="form-group">
              <label for="password">Password</label>
              <input type="password" id="password" required placeholder="Enter your password">
            </div>
            <button type="submit" class="primary-btn full-width" id="authSubmitBtn">Login</button>
          </form>
          <p class="auth-switch">
            <span id="authSwitchText">Don't have an account?</span>
            <a href="#" id="authSwitchBtn">Sign Up</a>
          </p>
          <button id="backToHomeBtn" class="text-btn">Back to Home</button>
        </div>
      </div>
    </div>

    <!-- Deck Selection Screen -->
    <div class="screen hidden" id="deckScreen">
      <div class="decks" id="decksContainer"></div>
      <button id="newDeckBtn" class="primary-btn"><i class="fas fa-plus"></i> New Deck</button>
    </div>

    <!-- Editor Screen -->
    <div class="screen hidden" id="editorScreen">
      <div class="editor-header">
        <h2 id="currentDeckName">Deck Name</h2>
        <div class="editor-actions">
          <button id="togglePdfBtn" class="secondary-btn"><i class="fas fa-file-pdf"></i> Show PDF</button>
          <button id="studyBtn" class="primary-btn"><i class="fas fa-book-open"></i> Study</button>
          <button id="quizBtn" class="primary-btn"><i class="fas fa-question-circle"></i> Quiz</button>
          <button id="examBtn" class="primary-btn"><i class="fas fa-graduation-cap"></i> Exam</button>
          <button id="cramBtn" class="primary-btn" style="background-color: #ff5722;"><i class="fas fa-fire"></i>
            Cram</button>
          <button id="scheduleBtn" class="primary-btn" style="background-color: #4285F4;"><i
              class="fas fa-calendar-alt"></i> Schedule</button>
          <button id="backToDecksBtn"><i class="fas fa-arrow-left"></i> Decks</button>
        </div>
      </div>

      <div class="editor-container">
        <!-- PDF Viewer Panel -->
        <div id="pdfPanel" class="pdf-panel hidden">
          <div class="pdf-controls">
            <input type="file" id="pdfUpload" accept=".pdf" class="hidden-input">
            <button onclick="document.getElementById('pdfUpload').click()" class="icon-btn" title="Upload PDF">
              <i class="fas fa-upload"></i>
            </button>

            <div class="page-nav">
              <button id="prevPageBtn" class="icon-btn" disabled><i class="fas fa-chevron-left"></i></button>
              <span id="pageInfo">Page <span id="pageNum">--</span> / <span id="pageCount">--</span></span>
              <button id="nextPageBtn" class="icon-btn" disabled><i class="fas fa-chevron-right"></i></button>
            </div>

            <div class="zoom-nav">
              <button id="zoomOutBtn" class="icon-btn"><i class="fas fa-minus"></i></button>
              <button id="zoomInBtn" class="icon-btn"><i class="fas fa-plus"></i></button>
            </div>

            <button id="ocrBtn" class="primary-btn small-btn" disabled><i class="fas fa-magic"></i> Scan Page</button>
          </div>

          <div id="pdfContainer" class="pdf-container">
            <canvas id="pdfCanvas"></canvas>
            <div id="ocrOverlay" class="ocr-overlay hidden">
              <div class="loader"></div>
              <p>Scanning text...</p>
            </div>
          </div>

          <div id="ocrResultContainer" class="ocr-result-container hidden">
            <div class="ocr-actions">
              <span>Extracted Text</span>
              <div>
                <button id="copyToFrontBtn" class="text-btn small">To Front</button>
                <button id="copyToBackBtn" class="text-btn small">To Back</button>
                <button id="closeOcrBtn" class="icon-btn"><i class="fas fa-times"></i></button>
              </div>
            </div>
            <textarea id="ocrText" readonly></textarea>
          </div>
        </div>

        <!-- Card Editor Panel -->
        <div id="cardEditorPanel" class="card-editor-panel">
          <div class="cards" id="cardsContainer"></div>
          <button id="addCardBtn" class="primary-btn"><i class="fas fa-plus"></i> Add Card</button>
        </div>
      </div>
    </div>

    <!-- Study Screen -->
    <div class="screen hidden" id="studyScreen">
      <div class="study-header">
        <h2>Study Mode</h2>
        <div class="study-actions">
          <button id="shuffleBtn"><i class="fas fa-random"></i> Shuffle</button>
          <button id="exitStudyBtn"><i class="fas fa-times"></i> Exit</button>
        </div>
      </div>
      <div class="flashcard-container">
        <div class="flashcard" id="flashcard">
          <div class="card-face front" id="cardFront"></div>
          <div class="card-face back" id="cardBack"></div>
        </div>
        <div class="flashcard-nav">
          <button id="prevCardBtn"><i class="fas fa-chevron-left"></i></button>
          <div class="progress" id="progress">1/10</div>
          <button id="nextCardBtn"><i class="fas fa-chevron-right"></i></button>
        </div>
        <button id="flipCardBtn" class="primary-btn"><i class="fas fa-sync-alt"></i> Flip Card</button>
      </div>
    </div>

    <!-- Quiz Screen -->
    <div class="screen hidden" id="quizScreen">
      <div class="quiz-header">
        <h2>Quiz Mode</h2>
        <button id="exitQuizBtn"><i class="fas fa-times"></i> Exit</button>
      </div>
      <div class="quiz-container">
        <div class="quiz-question" id="quizQuestion"></div>
        <div class="quiz-options" id="quizOptions"></div>
        <button id="nextQuizBtn" class="hidden primary-btn">Next Question</button>
        <div class="quiz-score" id="quizScore">Score: 0/0</div>
      </div>
    </div>

    <!-- Exam Screen -->
    <div class="screen hidden" id="examScreen">
      <div class="exam-header">
        <h2>Exam Mode</h2>
        <button id="exitExamBtn"><i class="fas fa-times"></i> Exit</button>
      </div>
      <div class="exam-container">
        <div class="exam-info">
          <div class="exam-timer" id="examTimer">Time: 30:00</div>
          <div class="exam-progress" id="examProgress">Question 1/10</div>
        </div>
        <div class="exam-question" id="examQuestion"></div>
        <div class="exam-options" id="examOptions"></div>
        <div class="exam-navigation">
          <button id="prevExamBtn"><i class="fas fa-chevron-left"></i> Previous</button>
          <button id="nextExamBtn" class="primary-btn">Next <i class="fas fa-chevron-right"></i></button>
          <button id="submitExamBtn" class="submit-btn hidden">Submit Exam</button>
        </div>
        <div class="exam-score hidden" id="examScore">Score: 0/0 (0%)</div>
      </div>
    </div>

    <!-- Cram Mode Screen (Renamed from Mastery) -->
    <div class="screen hidden" id="cramScreen">
      <div class="study-header">
        <h2>Cram Mode <span id="cramSessionType" class="session-badge"></span></h2>
        <button id="exitCramBtn"><i class="fas fa-times"></i> Exit</button>
      </div>
      <div class="mastery-container">
        <div class="mastery-progress">Remaining Cards: <span id="cramCount">0</span></div>

        <div class="flashcard-container">
          <div class="flashcard" id="cramCard">
            <div class="hard-card-badge hidden" id="cramHardBadge"><i class="fas fa-exclamation-triangle"></i> Hard Card
            </div>
            <div class="card-face front" id="cramFront"></div>
            <div class="card-face back" id="cramBack"></div>
          </div>
        </div>

        <div class="mastery-controls" id="cramControls">
          <button id="showCramAnswerBtn" class="primary-btn">Show Answer</button>
          <div class="grading-buttons hidden" id="gradingButtons">
            <button id="markWrongBtn" class="grade-btn wrong"><i class="fas fa-times"></i> Was Wrong</button>
            <button id="markRightBtn" class="grade-btn right"><i class="fas fa-check"></i> Got It Right</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats Screen -->
    <div class="screen hidden" id="statsScreen">
      <div class="editor-header">
        <h2>Your Progress</h2>
        <button id="backToDeckFromStatsBtn"><i class="fas fa-arrow-left"></i> Back</button>
      </div>
      <div class="stats-container">
        <div class="stats-summary">
          <div class="stat-card">
            <h3>Today's Sessions</h3>
            <span id="todaySessionCount" class="stat-value">0</span>
            <p>Pomodoro blocks completed</p>
          </div>
        </div>

        <div class="chart-section">
          <h3>Last 7 Days</h3>
          <div class="bar-chart" id="weeklyChart">
            <!-- Bars injected via JS -->
          </div>
        </div>

        <div class="motivation-box" id="motivationBox">
          <i class="fas fa-lightbulb"></i>
          <p id="motivationText">Keep going! Consistency is key.</p>
        </div>
      </div>
    </div>
  </div>
  </div>

  <!-- Floating Pomodoro Widget -->
  <div id="pomodoroWidget" class="pomodoro-widget collapsed">
    <!-- Collapsed Button -->
    <button id="pomoToggleBtn" class="pomo-fab" title="Open Pomodoro Timer">
      <i class="fas fa-stopwatch"></i>
    </button>

    <!-- Expanded Card -->
    <div class="pomo-card">
      <div class="pomo-header">
        <h3>Pomodoro</h3>
        <div class="pomo-header-actions">
          <button id="pomoStatsBtn" class="icon-btn" title="View Stats"><i class="fas fa-chart-bar"></i></button>
          <button id="pomoCloseBtn" class="icon-btn"><i class="fas fa-chevron-down"></i></button>
        </div>
      </div>
      <div class="pomo-display">
        <span id="pomoTime">25:00</span>
      </div>
      <div class="pomo-controls">
        <button id="pomoStartBtn" class="primary-btn small-btn"><i class="fas fa-play"></i> Start</button>
        <button id="pomoResetBtn" class="secondary-btn small-btn"><i class="fas fa-redo"></i> Reset</button>
      </div>
      <div class="pomo-modes">
        <button class="pomo-mode-btn active" data-mode="work">Work</button>
        <button class="pomo-mode-btn" data-mode="short">Short Break</button>
        <button class="pomo-mode-btn" data-mode="long">Long Break</button>
      </div>
    </div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- PDF.js and Tesseract.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  </script>
  <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>

  <script src="firebase-config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="script.js"></script>
</body>

</html>